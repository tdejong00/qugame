[gd_scene load_steps=18 format=3 uid="uid://cjpyd75nd3je5"]

[ext_resource type="Script" path="res://scenes/levels/tutorial/tutorial.gd" id="1_i5e8u"]
[ext_resource type="PackedScene" uid="uid://ckk03qsadcwlw" path="res://scenes/entities/player/player.tscn" id="2_f23gd"]
[ext_resource type="PackedScene" uid="uid://bsi2sm86hkhor" path="res://scenes/objects/qubit/qubit.tscn" id="3_gy2aj"]
[ext_resource type="PackedScene" uid="uid://5ye6f6br2bts" path="res://scenes/user_interface/user_interface.tscn" id="4_4kfsi"]
[ext_resource type="PackedScene" uid="uid://c8b5k7lep8tea" path="res://scenes/chunks/end_chunk.tscn" id="4_jdtq0"]
[ext_resource type="PackedScene" uid="uid://o2xud88mln6v" path="res://scenes/objects/door/door.tscn" id="4_jg1ue"]
[ext_resource type="PackedScene" uid="uid://65xnlas5jt2i" path="res://scenes/objects/quantum_gate_slot/quantum_gate_slot.tscn" id="6_brcmd"]
[ext_resource type="PackedScene" uid="uid://e2dv2absvtoc" path="res://scenes/objects/teleporter/teleporter.tscn" id="8_m1dnc"]

[sub_resource type="ProceduralSkyMaterial" id="ProceduralSkyMaterial_gyik4"]
sky_top_color = Color(0.134281, 0.16838, 0.215799, 1)
sky_horizon_color = Color(0.598989, 0.597969, 0.598742, 1)
ground_bottom_color = Color(0.261676, 0.223495, 0.179171, 1)
ground_horizon_color = Color(0.598989, 0.597969, 0.598742, 1)

[sub_resource type="Sky" id="Sky_4i27a"]
sky_material = SubResource("ProceduralSkyMaterial_gyik4")

[sub_resource type="Environment" id="Environment_hc8un"]
background_mode = 2
sky = SubResource("Sky_4i27a")
tonemap_mode = 2
glow_enabled = true

[sub_resource type="GDScript" id="GDScript_1ayj8"]
script/source = "extends Level

@onready var _goal_qubit: Qubit = $Objects/Circuit/GoalQubit
@onready var _input_qubit: Qubit = $Objects/Circuit/InputQubit
@onready var _quantum_gate_slot: QuantumGateSlot = $Objects/Circuit/InputQubit/QuantumGateSlot

func _ready() -> void:
    SignalBus.hide_hotbar.emit()
    await get_tree().create_timer(LEVEL_DELAY).timeout
    SignalBus.show_hotbar.emit()
    LevelRestrictions.reset()

    await display(\"Welcome to your first puzzle!\")
    await display(\"Now that you've learned about qubits and the Identity gate, let's introduce two important gates: Pauli-X and Hadamard.\")
    await display(\"First up, the Pauli-X gate. Let's try it out!\")

    # Wait for player to apply X gate
    _quantum_gate_slot.active = true
    LevelRestrictions.allow_gate(QuantumGate.Type.PAULI_X)
    SignalBus.restrictions_updated.emit()
    await SignalBus.circuit_changed
    _quantum_gate_slot.active = false

    await display(\"Great! Youâ€™ve flipped the qubit's state.\")
    await display(\"Now let's explore a more powerful gate: the Hadamard gate.\")
    await display(\"The Hadamard gate puts the gate into a state of superposition.\")
    await display(\"Give it a try!\")

    # Wait for player to apply H gate
    _quantum_gate_slot.active = true
    LevelRestrictions.allow_gate(QuantumGate.Type.HADAMARD)
    SignalBus.restrictions_updated.emit()
    var expected = Qubit.from_basis_state(Qubit.BasisState.PLUS_REAL)
    while not _input_qubit.evaluate().equals(expected):
        await SignalBus.circuit_changed
    _quantum_gate_slot.active = false

    await display(\"Great success!\")
"

[sub_resource type="ProceduralSkyMaterial" id="ProceduralSkyMaterial_svl5k"]
sky_top_color = Color(0.134281, 0.16838, 0.215799, 1)
sky_horizon_color = Color(0.598989, 0.597969, 0.598742, 1)
ground_bottom_color = Color(0.261676, 0.223495, 0.179171, 1)
ground_horizon_color = Color(0.598989, 0.597969, 0.598742, 1)

[sub_resource type="Sky" id="Sky_5thir"]
sky_material = SubResource("ProceduralSkyMaterial_svl5k")

[sub_resource type="Environment" id="Environment_bt4oo"]
background_mode = 2
sky = SubResource("Sky_5thir")
tonemap_mode = 2
glow_enabled = true

[sub_resource type="Resource" id="Resource_m2cjg"]
metadata/__load_path__ = "res://assets/mesh_libraries/tiles.tres"

[sub_resource type="PackedScene" id="PackedScene_k0xjw"]
_bundled = {
"conn_count": 0,
"conns": PackedInt32Array(),
"editable_instances": [],
"names": PackedStringArray("Tutorial2", "Node3D", "script", "WorldEnvironment", "WorldEnvironment", "environment", "World", "GridMap", "mesh_library", "cell_size", "data", "metadata/_editor_floor_", "Player", "transform", "UserInterface", "Objects", "Node3D", "Circuit", "Node3D", "GoalQubit", "transform", "visible", "is_gold", "initial_state", "InputQubit", "transform", "next_slot", "QuantumGateSlot", "transform", "qubit_in", "Lamps", "Node3D", "OmniLight3D", "OmniLight3D", "transform", "light_energy", "omni_range", "omni_attenuation", "OmniLight3D2", "OmniLight3D", "transform", "light_energy", "omni_range", "omni_attenuation", "OmniLight3D3", "OmniLight3D", "transform", "light_energy", "omni_range", "omni_attenuation", "OmniLight3D6", "OmniLight3D", "transform", "light_energy", "omni_range", "omni_attenuation", "OmniLight3D4", "OmniLight3D", "transform", "light_energy", "omni_range", "omni_attenuation", "OmniLight3D5", "OmniLight3D", "transform", "light_energy", "omni_range", "omni_attenuation", "Door", "transform", "Teleporter", "transform"),
"node_count": 19,
"node_paths": [NodePath("."), NodePath("."), NodePath("."), NodePath("."), NodePath("."), NodePath("./Objects"), NodePath("./Objects/Circuit"), NodePath("./Objects/Circuit"), NodePath("./Objects/Circuit/InputQubit"), NodePath("./Objects"), NodePath("./Objects/Lamps"), NodePath("./Objects/Lamps"), NodePath("./Objects/Lamps"), NodePath("./Objects/Lamps"), NodePath("./Objects/Lamps"), NodePath("./Objects/Lamps"), NodePath("./Objects"), NodePath("./Objects")],
"nodes": PackedInt32Array(-1, -1, 1, 0, -1, 1, 2, 0, 0, 1073741824, 0, 4, 3, -1, 1, 5, 1, 0, 1073741825, 0, 7, 6, -1, 4, 8, 2, 9, 3, 10, 4, 11, 5, 0, 1073741826, 0, 2147483647, 12, 6, 1, 13, 7, 0, 1073741827, 0, 2147483647, 14, 8, 0, 0, 1073741828, 0, 16, 15, -1, 0, 0, 1073741829, 0, 18, 17, -1, 0, 0, 1073741830, 0, 2147483647, 19, 9, 4, 20, 10, 21, 11, 22, 12, 23, 13, 0, 1073741831, 0, 2147483647, 24, 14, 2, 25, 15, 1073741850, 16, 0, 1073741832, 0, 2147483647, 27, 17, 2, 28, 18, 1073741853, 19, 0, 1073741833, 0, 31, 30, -1, 0, 0, 1073741834, 0, 33, 32, -1, 4, 34, 20, 35, 21, 36, 22, 37, 23, 0, 1073741835, 0, 39, 38, -1, 4, 40, 24, 41, 25, 42, 26, 43, 27, 0, 1073741836, 0, 45, 44, -1, 4, 46, 28, 47, 29, 48, 30, 49, 31, 0, 1073741837, 0, 51, 50, -1, 4, 52, 32, 53, 33, 54, 34, 55, 35, 0, 1073741838, 0, 57, 56, -1, 4, 58, 36, 59, 37, 60, 38, 61, 39, 0, 1073741839, 0, 63, 62, -1, 4, 64, 40, 65, 41, 66, 42, 67, 43, 0, 1073741840, 0, 2147483647, 68, 44, 1, 69, 45, 0, 1073741841, 0, 2147483647, 70, 46, 1, 71, 47, 0),
"variants": [SubResource("GDScript_1ayj8"), SubResource("Environment_bt4oo"), SubResource("Resource_m2cjg"), Vector3(4, 1, 4), {
"cells": PackedInt32Array(65533, 65533, 11, 65532, 2, 1048587, 65533, 2, 1048587, 65534, 2, 1048587, 65535, 2, 1048587, 0, 2, 1048587, 1, 2, 1048587, 2, 2, 1048587, 3, 65534, 1048587, 3, 65535, 1048587, 3, 0, 1048587, 3, 1, 1048587, 3, 2, 1048587, 3, 65533, 11, 2, 65533, 11, 1, 65533, 11, 0, 65533, 11, 65535, 65533, 11, 65534, 65533, 11, 327677, 65533, 1048587, 327678, 65533, 1048587, 327679, 65533, 1048587, 262144, 65533, 1048587, 262147, 65533, 1048587, 262146, 65533, 1048587, 262147, 65534, 1048587, 262147, 65535, 1048587, 262147, 0, 1048587, 262147, 1, 1048587, 262147, 2, 1048587, 262146, 2, 1048587, 262145, 2, 1048587, 327679, 2, 1048587, 262144, 2, 1048587, 327678, 2, 1048587, 327677, 2, 1048587, 327676, 2, 1048587, 589820, 65533, 1048587, 589821, 65533, 1441803, 589822, 65533, 1048587, 589823, 65533, 1441803, 524288, 65533, 1441803, 524289, 65533, 1048587, 524290, 65533, 1441803, 524291, 65533, 1441803, 524291, 65534, 1441803, 524291, 65535, 1441803, 524291, 0, 1441803, 524291, 1, 1441803, 524291, 2, 1048587, 524290, 2, 1048587, 524289, 2, 1048587, 524288, 2, 1048587, 589823, 2, 1048587, 589822, 2, 1048587, 589821, 2, 1048587, 589820, 2, 1048587, 589820, 1, 1048587, 589820, 0, 1048587, 589820, 65535, 1048587, 589820, 65534, 1048587, 589821, 65534, 1441803, 589821, 65535, 1441803, 589821, 0, 1441803, 589821, 1, 1441803, 589822, 1, 1441803, 589822, 0, 1441803, 589822, 65535, 1441803, 589822, 65534, 1441803, 589823, 65534, 1441803, 589823, 65535, 1441803, 589823, 0, 1441803, 589823, 1, 1441803, 524288, 0, 1441803, 524288, 65535, 1441803, 524288, 65534, 1441803, 524289, 65535, 1441803, 524289, 65534, 1441803, 524290, 65534, 1441803, 524289, 0, 1441803, 524290, 0, 1441803, 524290, 65535, 1441803, 524289, 1, 1441803, 524290, 1, 1441803, 524288, 1, 1441803, 262144, 65534, 1048587, 262144, 1, 1048587, 0, 1, 1048587, 0, 65534, 1048587, 262145, 65533, 1441803, -262144, 1, 1048587, -262144, 0, 1048587, -262144, 65535, 1048587, -262144, 65534, 1048587, -196609, 65534, 1048587, -196609, 65535, 1048587, -196609, 0, 1048587, -196609, 1, 1048587, -262144, 2, 1048587, -196609, 2, 1048587, -262144, 65533, 1048587, -196609, 65533, 1048587, -196610, 65533, 1048587, -196611, 65533, 1048587, -196610, 65534, 1048587, -196611, 65534, 1048587, -196610, 65535, 1048587, -196611, 65535, 1048587, -262143, 65534, 1048587, -262142, 65534, 1048587, -262141, 65534, 1048587, -262141, 65535, 1048587, -262142, 65535, 1048587, -262143, 65535, 1048587, -262143, 0, 1048587, -262143, 1, 1048587, -262143, 2, 1048587, -262142, 2, 1048587, -262142, 0, 1048587, -262142, 1, 1048587, -262141, 0, 1048587, -262141, 1, 1048587, -262141, 2, 1048587, -196610, 0, 1048587, -196610, 1, 1048587, -196610, 2, 1048587, -196611, 2, 1048587, -196612, 2, 1048587, -196612, 1, 1048587, -196611, 1, 1048587, -196612, 0, 1048587, -196612, 65535, 1048587, -196612, 65534, 1048587, -196612, 65533, 1048587, -196611, 0, 655371, -262143, 65533, 1048587, -262142, 65533, 1048587, -262141, 65533, 1048587, 65532, 65533, 11, 65531, 65533, 11, 65531, 65534, 11, 65531, 65535, 11, 65531, 0, 11, 65531, 1, 11, 65531, 2, 11, 327675, 65533, 11, 327676, 65533, 11, 327675, 65534, 11, 327675, 65535, 11, 327675, 0, 11, 327675, 1, 11, 327675, 2, 11, -196613, 65535, 11, -196613, 65533, 11, -196613, 0, 11, -196613, 1, 11, -196613, 65534, 11, -196613, 2, 11, 589819, 2, 1441803, 589819, 1, 1441803, 589819, 0, 1441803, 589819, 65535, 1441803, 589819, 65534, 1441803, 589819, 65533, 1441803)
}, Vector3(0, 8, 0), ExtResource("2_f23gd"), Transform3D(0.848528, 0, -0.848528, 0, 1.2, 0, 0.848528, 0, 0.848528, -14, 0.5, 6), ExtResource("4_4kfsi"), ExtResource("3_gy2aj"), Transform3D(1.5, 0, 0, 0, 1.5, 0, 0, 0, 1.5, -10, 0.5, -4), false, true, 1, ExtResource("3_gy2aj"), Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -12, 0.5, 0), NodePath("QuantumGateSlot"), ExtResource("6_brcmd"), Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 2, 0, 0), NodePath(".."), Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -4, 8, -4), 10.0, 20.0, 2.0, Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -4, 8, 4), 10.0, 20.0, 2.0, Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 8, 8, 4), 10.0, 20.0, 2.0, Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 8, 8, -6), 10.0, 20.0, 2.0, Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -12, 8, -4), 10.0, 20.0, 2.0, Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -12, 8, 4), 10.0, 20.0, 2.0, ExtResource("4_jg1ue"), Transform3D(-8.74228e-08, 0, -2, 0, 2, 0, 2, 0, -8.74228e-08, 2.5, 0.5, 0), ExtResource("8_m1dnc"), Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -14, 0.15, 6)],
"version": 3
}

[node name="Tutorial" type="Node3D"]
script = ExtResource("1_i5e8u")

[node name="WorldEnvironment" type="WorldEnvironment" parent="."]
environment = SubResource("Environment_hc8un")

[node name="Player" parent="." instance=ExtResource("2_f23gd")]
transform = Transform3D(1.5, 0, 0, 0, 1.5, 0, 0, 0, 1.5, 2, 4, 12)

[node name="UserInterface" parent="." instance=ExtResource("4_4kfsi")]

[node name="World" type="Node3D" parent="."]

[node name="EndChunk" parent="World" instance=ExtResource("4_jdtq0")]

[node name="EndChunk2" parent="World" instance=ExtResource("4_jdtq0")]
transform = Transform3D(-1, 0, -8.74228e-08, 0, 1, 0, 8.74228e-08, 0, -1, 28, 0, 16)

[node name="Objects" type="Node3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 14, 3.5, 8)

[node name="Circuit" type="Node3D" parent="Objects"]

[node name="GoalQubit" parent="Objects/Circuit" instance=ExtResource("3_gy2aj")]
transform = Transform3D(1.5, 0, 0, 0, 1.5, 0, 0, 0, 1.5, -8, 0.5, -4)
visible = false
is_gold = true

[node name="InputQubit" parent="Objects/Circuit" node_paths=PackedStringArray("next_slot") instance=ExtResource("3_gy2aj")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -12, 0.5, 0)
next_slot = NodePath("QuantumGateSlot")

[node name="QuantumGateSlot" parent="Objects/Circuit/InputQubit" node_paths=PackedStringArray("qubit_in") instance=ExtResource("6_brcmd")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 2, 0, 0)
visible = false
qubit_in = NodePath("..")

[node name="Door" parent="Objects" instance=ExtResource("4_jg1ue")]
transform = Transform3D(-1.31134e-07, 0, -3, 0, 3, 0, 3, 0, -1.31134e-07, 0.75, 0.5, 0)

[node name="Teleporter" parent="Objects" instance=ExtResource("8_m1dnc")]
transform = Transform3D(2, 0, 0, 0, 2, 0, 0, 0, 2, 10, -0.2, 0)
next_scene = SubResource("PackedScene_k0xjw")
active = true

[node name="Lamp" type="OmniLight3D" parent="Objects"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 11.5, 4)
light_energy = 24.0
omni_range = 24.0
omni_attenuation = 2.0

[node name="Lamp2" type="OmniLight3D" parent="Objects"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 11.5, -4)
light_energy = 24.0
omni_range = 24.0
omni_attenuation = 2.0
